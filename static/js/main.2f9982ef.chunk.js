(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{147:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(51),i=a.n(l),o=(a(68),a(148)),c=a(156),s=a(4),m=a(22),u=a(157),p=Object(m.a)(function(e){var t=e.theme,a=Object(s.a)(e,["theme"]);return r.a.createElement(c.a,Object.assign({display:"flex",padding:16,background:t.palette.blue.base},a),r.a.createElement(c.a,{flex:1,alignItems:"center",display:"flex"},r.a.createElement(u.a,{color:t.colors.border.default},"Capgen")),r.a.createElement(c.a,null))}),d=a(158),h=a(159),g=a(15),f=a(39),E=a.n(f),b=a(29),y=a(3),v=a(53),x=a(5),C=a(7),w=a(6),R=a(8),O=window.libcapgen(),j=null,k=[];O.onRuntimeInitialized=function(){j={optimize:function(){return O.optimize.apply(O,arguments)}},k.map(function(e){return e()})};var S=function(){return new Promise(function(e){null===j?k.push(function(){return e(j)}):e(j)})},F=a(164),z=13,B=["Domestic Equity","Global Equity","Real Estate","Alternative","Credit","Bonds 2-Year","Bonds 5-Year","Cash","FTA","Domestic Equity Futures","Interest Rate Swap 2-Year","Interest Rate Swap 5-Year","Interest Rate Swap 20-Year"],W=function(e){function t(){var e,a;Object(x.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(C.a)(this,(e=Object(w.a)(t)).call.apply(e,[this].concat(r)))).state={history:[],loading:!1,metrics:{fitness:0,expectedReturn:0,expectedRisk:0},weights:[],finalReturns:[]},a.optimize=function(){var e=Object(v.a)(E.a.mark(function e(t){var n,r,l,i,o,c,s,m,u,p,d,h,g,f,v,x;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:for(n=e.sent,r=n.optimize(t),l={fitness:r.fitness,expectedReturn:r.expectedReturn,expectedRisk:r.expectedRisk},i=Math.pow(2,t.steps-1),o=[],c=-1,s=-1,m=0;m<i;++m)u=r.finalWealths.get(m)-1,o.push(u),(c<0||u>o[c])&&(c=m),(s<0||u<o[s])&&(s=m);for(p=[r.finalWealths.get(c)],d=i+c-1;d>=0;)p.push(r.intermediateWealths.get(d)),d=Math.floor((d-1)/2);for(p.reverse(),h=[r.finalWealths.get(s)],g=i+s-1;g>=0;)h.push(r.intermediateWealths.get(g)),g=Math.floor((g-1)/2);for(h.reverse(),f=[],v=0;v<z;++v)f.push(r.individual.get(v));x={title:"Backtest",timestamp:Object(F.a)(new Date,"yyyy-MM-dd HH:mm:ss"),metrics:Object(y.a)({},l),weights:[].concat(f),finalReturns:[].concat(o),bestPath:[].concat(p),worstPath:[].concat(h)},a.setState(Object(y.a)({},a.state,x,{history:[x].concat(Object(b.a)(a.state.history))}));case 22:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(R.a)(t,e),t}(g.a),X=Object(m.a)(function(e){var t=e.theme,a=Object(s.a)(e,["theme"]);return r.a.createElement(c.a,Object.assign({height:"100%",overflowY:"auto",width:"200px",background:"tint1",borderRight:"1px solid ".concat(t.colors.border.default)},a),r.a.createElement(g.c,{to:[W]},function(e){return e.state.history.map(function(e,a){return r.a.createElement(c.a,{key:a,padding:16,borderBottom:"1px solid ".concat(t.colors.border.default)},r.a.createElement(u.a,{size:200},e.title),r.a.createElement(u.a,{size:100},e.timestamp),r.a.createElement(d.a,{marginBottom:0},r.a.createElement(I,{icon:"symbol-triangle-up"},e.metrics.expectedReturn.toFixed(2)),r.a.createElement(I,{icon:"symbol-triangle-down"},e.metrics.expectedRisk.toFixed(2))))})}))}),I=function(e){var t=e.children,a=Object(s.a)(e,["children"]);return r.a.createElement(h.a,Object.assign({size:100,display:"inline-block",marginTop:0,marginBottom:0,marginRight:32,paddingLeft:0,color:"muted",fontSize:11},a),t)},Y=a(163),D=a(59),P=a(165),M=a(18),A=a(162),q=a(41),T=a(35),V=a(160),G=a(161),H=function(e){var t=e.children,a=Object(s.a)(e,["children"]);return r.a.createElement(c.a,Object.assign({marginTop:16},a),t)},J=function(e){var t=e.children,a=Object(s.a)(e,["children"]);return r.a.createElement(V.a,a,t)},N=function(e){var t=e.children,a=Object(n.useState)(0),l=Object(T.a)(a,2),i=l[0],o=l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{marginX:-4},r.a.Children.map(t,function(e,t){var a=e.props,n=a.title,l=(a.children,Object(s.a)(a,["title","children"]));return r.a.createElement(J,Object.assign({key:t,is:"a",isSelected:t===i,onSelect:function(){return o(t)}},l),n)})),r.a.Children.map(t,function(e,t){return i===t&&r.a.createElement(H,{key:t},e.props.children)}))},K=Object(m.a)(function(e){var t=e.theme,a=e.values,n=e.handleChange;e.setFieldValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{background:"tint1",borderBottom:"1px solid ".concat(t.colors.border.default),display:"flex",paddingX:16,paddingY:8,flexDirection:"column"},r.a.createElement(c.a,{flex:1},r.a.createElement(u.a,{size:200},"Parameters"))),r.a.createElement(c.a,{borderBottom:"1px solid ".concat(t.colors.border.default),display:"flex",padding:16,flexDirection:"column"},r.a.createElement(N,null,r.a.createElement(J,{title:"Portfolio"},r.a.createElement(Z,{values:a,handleChange:n})),r.a.createElement(J,{title:"Simulation"},r.a.createElement(_,{values:a,handleChange:n})),r.a.createElement(J,{title:"Optimizer"},r.a.createElement(ee,{values:a,handleChange:n})),r.a.createElement(J,{title:"Reallocations"},r.a.createElement(U,{values:a,handleChange:n})),r.a.createElement(J,{title:"Constraints"},r.a.createElement(Q,{values:a,handleChange:n})),r.a.createElement(J,{title:"Margins"},r.a.createElement($,{values:a,handleChange:n})))))}),L=function(e){return r.a.createElement(P.a,Object.assign({flexBasis:"28%",marginX:8},e))},$=function(e){var t=e.values,a=e.handleChange;return r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:8},r.a.createElement(c.a,null,r.a.createElement(u.a,{marginBottom:8},"Instrument allocation constraints"),r.a.createElement(M.a,null,"Define constraints on how large proportion of the portfolio might be invested in a particular instrument."),r.a.createElement(c.a,{is:"table",marginX:-4,marginY:16},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement(M.a,{is:"th"},"Instrument"),r.a.createElement(M.a,{is:"th"},"Required margin"))),r.a.createElement("tbody",null,t.marginConstraints.map(function(e,n){return r.a.createElement("tr",{key:n},r.a.createElement("td",null,r.a.createElement(A.a,null,B[n])),r.a.createElement("td",null,r.a.createElement(q.a,{type:"number",name:"marginConstraints.".concat(n),value:t.marginConstraints[n],onChange:a,step:"any",min:0,max:1})))})))))},Q=function(e){var t=e.values,a=e.handleChange;return r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:8},r.a.createElement(c.a,null,r.a.createElement(u.a,{marginBottom:8},"Instrument allocation constraints"),r.a.createElement(M.a,null,"Define constraints on how large proportion of the portfolio might be invested in a particular instrument."),r.a.createElement(c.a,{is:"table",marginX:-4,marginY:16},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement(M.a,{is:"th"},"Instrument"),r.a.createElement(M.a,{is:"th"},"Min"),r.a.createElement(M.a,{is:"th"},"Max"))),r.a.createElement("tbody",null,t.instrumentConstraints.map(function(e,n){return r.a.createElement("tr",{key:n},r.a.createElement("td",null,r.a.createElement(A.a,null,B[n])),r.a.createElement("td",null,r.a.createElement(q.a,{type:"number",name:"instrumentConstraints.".concat(n,".0"),value:t.instrumentConstraints[n][0],onChange:a,step:"any",min:0,max:1})),r.a.createElement("td",null,r.a.createElement(q.a,{type:"number",name:"instrumentConstraints.".concat(n,".1"),value:t.instrumentConstraints[n][1],onChange:a,step:"any",min:0,max:1})))})))))},U=function(e){var t=e.values,a=e.handleChange;return r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8},t.transactionCosts.map(function(e,n){return r.a.createElement(L,{key:n,name:"transactionCosts.".concat(n),label:B[n],placeholder:"0.0",value:t.transactionCosts[n],type:"number",onChange:a,step:"any",min:"0",max:"1"})}))},Z=function(e){var t=e.values,a=e.handleChange;return r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8},r.a.createElement(L,{label:"Risk aversion",hint:"Set to 0.0 to optimize without considering risk.",placeholder:"0.5",value:t.riskAversion,name:"riskAversion",type:"number",onChange:a,step:"any",min:"0",max:"1"}),r.a.createElement(L,{label:"Initial funding ratio",hint:"Initial funding ratio of the portfolio.",placeholder:"1.3",value:t.initialFundingRatio,name:"initialFundingRatio",type:"number",onChange:a,step:"any",min:"0"}),r.a.createElement(L,{label:"Target funding ratio",hint:"Penalize portfolios with funding ratio below this value.",placeholder:"1.3",value:t.targetFundingRatio,name:"targetFundingRatio",type:"number",onChange:a,step:"any",min:"0"}))},_=function(e){var t=e.values,a=e.handleChange;return r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8},r.a.createElement(L,{label:"Steps",hint:"Number of steps to simulate.",placeholder:"4",value:t.steps,name:"steps",type:"number",onChange:a,step:"any",min:"1",max:"12"}))},ee=function(e){var t=e.values,a=e.handleChange;return r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8},r.a.createElement(L,{label:"Population size",hint:"Number of individuals in the population.",placeholder:"100",value:t.populationSize,name:"populationSize",type:"number",onChange:a,step:"any",min:"0"}),r.a.createElement(L,{label:"Elitism copies",hint:"Keep a number of clones of the best individuals at iteration.",placeholder:"2",value:t.elitismCopies,name:"elitismCopies",type:"number",onChange:a,step:"any",min:"0"}),r.a.createElement(L,{label:"Generations",hint:"Iterate through this many generations.",placeholder:"100",value:t.generations,name:"generations",type:"number",onChange:a,step:"any",min:"1"}),r.a.createElement(L,{label:"Mutation rate",hint:"Probability of mutating a gene.",placeholder:"0.02",value:t.mutationRate,name:"mutationRate",type:"number",onChange:a,step:"any",min:"0",max:"1"}),r.a.createElement(L,{label:"Crossover rate",hint:"Probability of crossing two individuals.",placeholder:"0.02",value:t.crossoverRate,name:"crossoverRate",type:"number",onChange:a,step:"any",min:"0",max:"1"}))},te=a(57),ae=a.n(te),ne=a(58),re=a.n(ne)()(ae.a),le=Object(m.a)(function(e){var t=e.theme;return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{background:"tint1",borderBottom:"1px solid ".concat(t.colors.border.default),display:"flex",paddingX:16,paddingY:8,flexDirection:"column"},r.a.createElement(c.a,{flex:1},r.a.createElement(u.a,{size:200},"Results"))),r.a.createElement(c.a,{display:"flex",padding:16,flexDirection:"column"},r.a.createElement(N,null,r.a.createElement(J,{title:"Weights"},r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8,marginY:-8},r.a.createElement(g.c,{to:[W]},function(e){return e.state.weights.map(function(e,t){return r.a.createElement(ie,{key:t,title:B[t],value:e.toFixed(2)})})}))),r.a.createElement(J,{title:"Metrics"},r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8,marginY:-8},r.a.createElement(g.c,{to:[W]},function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{title:"Fitness",value:e.state.metrics.fitness.toFixed(2)}),r.a.createElement(ie,{title:"Expected Return",value:e.state.metrics.expectedReturn.toFixed(2)}),r.a.createElement(ie,{title:"Expected Risk",value:e.state.metrics.expectedRisk.toFixed(2)}))}))),r.a.createElement(J,{title:"Scenarios"},r.a.createElement(c.a,{display:"flex",flexWrap:"wrap",marginX:-8,marginY:-8},r.a.createElement(g.c,{to:[W]},function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{title:"Expected Returns"},r.a.createElement(re,{data:[{x:e.state.finalReturns,type:"histogram"}]})),r.a.createElement(ie,{title:"Best Scenario vs. Worst Scenario"},r.a.createElement(re,{data:[{y:e.state.bestPath,type:"scatter",name:"Best Scenario"},{y:e.state.worstPath,type:"scatter",name:"Worst Scenario"}]})))}))))))}),ie=function(e){var t=e.title,a=e.value,n=e.children,l=Object(s.a)(e,["title","value","children"]);return r.a.createElement(c.a,Object.assign({background:"tint1",padding:16,flexBasis:"15%",marginX:8,marginY:8,border:"default"},l),r.a.createElement(u.a,{size:200,marginBottom:8},t),"undefined"===typeof a?n:r.a.createElement(u.a,{size:800},a))},oe=Object(m.a)(function(e){var t=e.theme,a=Object(s.a)(e,["theme"]);return r.a.createElement(g.c,{to:[W]},function(e){return r.a.createElement(D.a,{initialValues:{populationSize:10,elitismCopies:2,generations:10,mutationRate:.02,crossoverRate:.02,steps:2,riskAversion:0,initialFundingRatio:1.3,targetFundingRatio:1.3,transactionCosts:[0,0,0,0,0,0,0,0,0,0,0,0,0],instrumentConstraints:[[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1],[0,1]],marginConstraints:[.05,.05,.05,.05]},onSubmit:function(t,a){a.setSubmitting;var n=[].concat(Object(b.a)(t.instrumentConstraints.map(function(e){return e[0]})),Object(b.a)(t.instrumentConstraints.map(function(e){return e[1]})));e.optimize(Object(y.a)({},t,{instrumentConstraints:n}))}},function(e){e.isSubmitting;var n=e.handleSubmit,l=e.values,i=e.handleChange,o=e.setFieldValue;return r.a.createElement("form",{onSubmit:n},r.a.createElement(c.a,Object.assign({display:"flex",flexDirection:"column"},a),r.a.createElement(c.a,{borderBottom:"1px solid ".concat(t.colors.border.default),display:"flex",padding:16,alignItems:"center"},r.a.createElement(c.a,{flex:1},r.a.createElement(u.a,null,"Backtest")),r.a.createElement(c.a,null,r.a.createElement(Y.a,{appearance:"primary",iconBefore:"play",type:"submit"},"Run"))),r.a.createElement(K,{values:l,handleChange:i,setFieldValue:o}),r.a.createElement(le,null)))})})}),ce=function(){return r.a.createElement(g.c,{to:[W]},function(e){return e.loading?r.a.createElement(o.a,{transform:"translate(-50%, -50%)",position:"absolute",left:"50%",top:"50%"}):r.a.createElement(c.a,{height:"100vh",display:"flex",flexDirection:"column"},r.a.createElement(p,null),r.a.createElement(c.a,{display:"flex",height:"calc(100% - ".concat("52px",")")},r.a.createElement(c.a,{flex:0,height:"100%"},r.a.createElement(X,null)),r.a.createElement(c.a,{flex:1,height:"100%"},r.a.createElement(oe,null))))})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(g.b,null,r.a.createElement(ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},63:function(e,t,a){e.exports=a(147)},68:function(e,t,a){}},[[63,1,2]]]);
//# sourceMappingURL=main.2f9982ef.chunk.js.map